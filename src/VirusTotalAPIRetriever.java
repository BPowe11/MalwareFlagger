import java.io.BufferedReader;
import java.net.URL;
import java.net.URLConnection;
import org.json.JSONObject;
import java.io.InputStreamReader;

public class VirusTotalAPIRetriever{

    public static boolean positiveAlarm(int positives) {
        System.out.println("Testing Alarms");
        CapstoneGUI.statusUpdater("Testing Alarms");
        if (positives>0){
            System.out.println("Alarms tested for");
            CapstoneGUI.statusUpdater("Alarms Tested for");
            return true;
            }
        else {
            System.out.println("Alarms tested for");
            CapstoneGUI.statusUpdater("Alarms Tested for");
            return false;
            }
        }
    
        
    public static int[] obtainIntDataArray(String hex) {
        CapstoneGUI.statusUpdater("Obtaining API");
        System.out.println("obtaining API");
        int dataArray[] = new int[5];
        try{
            URLConnection connection = new URL("https://www.virustotal.com/vtapi/v2/file/report?apikey=2ba3d31fb4e22c284b6540412114f4fa593ae4993c820f9891f02770602c72b8&resource="+hex).openConnection();
            BufferedReader in = new BufferedReader(new InputStreamReader(connection.getInputStream()));
            String inputline;
            StringBuffer response = new StringBuffer();
            while((inputline = in.readLine()) != null){
                response.append(inputline);
            }
            in.close();
            String jsonString = response.toString();
            JSONObject myResponse = new JSONObject(jsonString);
            dataArray[0] = (myResponse.getInt("positives"));  
            dataArray[1] = (myResponse.getInt("total")); 
            CapstoneGUI.statusUpdater("API Retrieved");
            System.out.println("API Retrieved");
            
        } catch (Exception e){
            CapstoneGUI.statusUpdater("No API for given file");
            System.out.println("No API for given file");
        }
        return dataArray;
        }
    }
